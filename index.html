<!DOCTYPE html>
<html lang="km">
<head>
  <meta charset="utf-8" />
  <title>ប្លង់បណ្តាយទុយោទឹកស្អាតសម្រាប់បច្ចុប្បន្ននិងឆ្នាំ២០៤០</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- CSS Dependencies -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-sidebar-v2/css/leaflet-sidebar.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-search/dist/leaflet-search.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />
  <style>
    body { 
      margin: 0; 
      padding: 0; 
      font-family: "Khmer OS", "Noto Sans Khmer", sans-serif; 
    }
    /* Increased header font-size to 32px */
    #header { 
      background: #005cbf; 
      color: #fff; 
      padding: 12px; 
      text-align: center; 
      font-size: 32px; 
    }
    #map { 
      position: absolute; 
      top: 48px; 
      bottom: 0; 
      left: 0; 
      right: 0; 
    }
    .leaflet-sidebar { 
      width: 260px !important; 
    }
    .leaflet-sidebar.collapsed { 
      width: 50px !important; 
    }
    .leaflet-sidebar-tabs a { 
      width: 50px; 
      height: 50px; 
      line-height: 50px; 
    }
    .leaflet-sidebar-content { 
      padding: 8px; 
      font-size: 14px; 
    }
    .leaflet-sidebar-header { 
      font-size: 16px; 
      margin-bottom: 8px; 
    }
    .layer-checkbox { 
      margin: 4px 0; 
    }
    #search-control .leaflet-search-wrap { 
      display: flex; 
      width: 100% !important; 
      margin-bottom: 10px; 
    }
    #search-control .leaflet-search-input { 
      flex: 1; 
      padding: 6px; 
      font-size: 16px; 
      border-radius: 4px; 
    }
    #search-control .leaflet-search-button { 
      margin-left: -32px; 
      width: 24px; 
      height: 24px; 
    }
    .legend {
      position: absolute; 
      bottom: 20px; 
      right: 10px; 
      background: #fff; 
      padding: 8px; 
      font-size: 14px; 
      border-radius: 4px; 
      box-shadow: 0 0 6px rgba(0,0,0,0.3); 
      width: 260px;
    }
    .legend-item { 
      display: flex; 
      align-items: center; 
      margin-bottom: 6px; 
      white-space: nowrap; 
    }
    .legend-item:last-child { 
      margin-bottom: 0; 
    }
    .legend i { 
      width: 18px; 
      height: 18px; 
      margin-right: 8px; 
      border: 1px solid #000; 
    }
    .legend i.circle { 
      border-radius: 50%; 
    }
    .leaflet-control-scale-denominator { 
      background: #fff; 
      padding: 4px 6px; 
      font-size: 12px; 
      border: 1px solid rgba(0,0,0,0.2); 
      border-radius: 4px; 
      margin-top: 4px; 
    }
  </style>
</head>
<body>
  <div id="header">ប្លង់បណ្តាយទុយោទឹកស្អាតសម្រាប់បច្ចុប្បន្ននិងឆ្នាំ២០៤០</div>
  <div id="sidebar" class="leaflet-sidebar collapsed">
    <div class="leaflet-sidebar-tabs">
      <ul role="tablist">
        <li>
          <a href="#layers" role="tab"><i class="fa fa-list"></i></a>
        </li>
        <li>
          <a href="#searchpane" role="tab"><i class="fa fa-search"></i></a>
        </li>
      </ul>
    </div>
    <div class="leaflet-sidebar-content">
      <div id="layers" class="leaflet-sidebar-pane">
        <h1 class="leaflet-sidebar-header">
          ស្រទាប់
          <button class="leaflet-sidebar-close">
            <i class="fa fa-chevron-right"></i>
          </button>
        </h1>
        <div id="layer-list"></div>
      </div>
      <div id="searchpane" class="leaflet-sidebar-pane">
        <h1 class="leaflet-sidebar-header">
          ស្វែងរក
          <button class="leaflet-sidebar-close">
            <i class="fa fa-chevron-right"></i>
          </button>
        </h1>
        <div id="search-control"></div>
      </div>
    </div>
  </div>
  <div id="map"></div>

  <!-- JS Dependencies -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-sidebar-v2/js/leaflet-sidebar.min.js"></script>
  <script src="https://unpkg.com/leaflet-search/dist/leaflet-search.min.js"></script>
  <script src="https://unpkg.com/leaflet.locatecontrol/dist/L.Control.Locate.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
  <script>
    (async function() {
      var map = L.map('map', { zoomControl:false }).setView([11.4, 104.5], 10);
      var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OSM',
        maxZoom: 19
      }).addTo(map);
      var esri = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: '© Esri',
        maxZoom: 19
      });
      L.control.layers({'Street': osm, 'Satellite': esri}).addTo(map);
      L.control.zoom({position: 'topright'}).addTo(map);
      L.control.scale({position: 'bottomleft', metric: true, imperial: false}).addTo(map);
      L.control.locate({ 
        position: 'topright', 
        strings: {title: 'ស្វែងរកទីតាំង​របស់ខ្ញុំ'}
      }).addTo(map);
      
      var sidebar = L.control.sidebar({container: 'sidebar', autopan: true}).addTo(map);
      sidebar.open('layers');
      
      var legend = L.control({position: 'bottomright'});
      legend.onAdd = () => {
        var d = L.DomUtil.create('div', 'legend');
        d.innerHTML = '<div class="legend-item"><i style="background:black"></i> បណ្តាញទុយោបច្ចុប្បន្ន</div>' +
                      '<div class="legend-item"><i style="background:white"></i> បណ្តាញទុយោពង្រីក</div>' +
                      '<div class="legend-item"><i class="circle" style="background:#3498db"></i> ទីតាំងប្រភពទឹក</div>' +
                      '<div class="legend-item"><i class="circle" style="background:#f1c40f"></i> ទីតាំងស្ថានីយទឹកស្អាត</div>';
        return d;
      };
      legend.addTo(map);
    })();
  </script>
</body>
</html>
